<div class="editorStyles">
  <div class="accordion">
    <ng-container [ngSwitch]="section?.value" class="accordion__panel">
      <ng-container *ngIf="section">
        <ng-container *ngTemplateOutlet="header; context: {$implicit: section}"></ng-container>
      </ng-container>
      <ng-container *ngSwitchCase="sectionsEnum.boxModel">
        <ng-container *ngTemplateOutlet="boxModel"></ng-container>
      </ng-container>
      <ng-container *ngSwitchCase="sectionsEnum.grid">
        <ng-container *ngTemplateOutlet="grid"></ng-container>
      </ng-container>
      <ng-container *ngSwitchCase="sectionsEnum.flex">
        <ng-container *ngTemplateOutlet="flex"></ng-container>
      </ng-container>
      <ng-container *ngSwitchDefault>
        <ng-container *ngTemplateOutlet="accordionList"></ng-container>
      </ng-container>
    </ng-container>
  </div>
</div>

<ng-template #boxModel>
  <div class="box-model">
    <ng-container *ngIf="target?.stylesFormGroup as formGroup">
      <form [formGroup]="target!.stylesFormGroup" class="property">
        <ng-container formArrayName="nodeStyles">
          <ng-container *ngFor="let property of $any(formGroup.get('nodeStyles')).controls; let i = index">
            <ng-container [formGroup]="property">
              <ng-container formArrayName="{{target?.getPropertyName(i)}}">
                <div class="property__name">{{target?.getPropertyName(i)}}</div>

                <ng-container
                  *ngFor="let valueType of $any(property).controls[$any(target?.getPropertyName(i))].controls; let j = index">
                  <div>{{target?.getValueTypeName(i,j)}}</div>
                  <ng-container [ngSwitch]="target?.getValueTypeName(i,j)">
                    <ng-container *ngSwitchCase="'pixels'">
                      <ng-container *ngTemplateOutlet="pixels; context: {$implicit: valueType}"></ng-container>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </ng-container>
            </ng-container>
          </ng-container>
        </ng-container>
      </form>

      <!-- <form [formGroup]="stylesForm" class="property">
        <div formGroupName="width">
          <div class="property__name">Width</div>
          
          <div formGroupName="pixels" class="property__subprop">
            <div class="property__wrapper">
              <p-inputSwitch formControlName="editable"></p-inputSwitch>
              <input [attr.disabled]="stylesForm.get('width.pixels.editable')?.value ? null : false"
                   formControlName="value" type="number">
              <div class="property__measurement-unit">px</div> 
            </div>      
          </div>

          <div formGroupName="percentage" class="property__subprop">
            <p-inputSwitch formControlName="editable"></p-inputSwitch>
            <p-slider
              [disabled]="!stylesForm.get('width.percentage.editable')?.value"
              formControlName="value"
              [min]="0"
              [max]="100"
            ></p-slider>
            <div class="property__measurement-unit">{{stylesForm.get('width.percentage.value')?.value}}%</div>
          </div>
        </div>

        <div formGroupName="height">
          <div class="property__name">Height</div>
          
          <div formGroupName="pixels" class="property__subprop">
            <div class="property__wrapper">
              <p-inputSwitch formControlName="editable"></p-inputSwitch>
              <input [attr.disabled]="stylesForm.get('height.pixels.editable')?.value ? null : false"
                   formControlName="value" type="number">
              <div class="property__measurement-unit">px</div>  
            </div> 
          </div>

          <div formGroupName="percentage" class="property__subprop">
            <p-inputSwitch formControlName="editable"></p-inputSwitch>
            <p-slider
              [disabled]="!stylesForm.get('height.percentage.editable')?.value"
              formControlName="value"
              [min]="0"
              [max]="100"
            ></p-slider>
            <div class="property__measurement-unit">{{stylesForm.get('height.percentage.value')?.value}}%</div>
          </div>
        </div>

        <div formGroupName="margin">
          <div class="property__name">Margin</div>
          
          <div formGroupName="pixels" class="property__subprop">
            <div class="property__wrapper">
              <p-inputSwitch formControlName="editable"></p-inputSwitch>
              <input [attr.disabled]="stylesForm.get('margin.pixels.editable')?.value ? null : false"
                   formControlName="value" type="text">
              <div class="property__measurement-unit"></div>  
            </div> 
          </div>

          <div formGroupName="percentage" class="property__subprop">
            <p-inputSwitch formControlName="editable"></p-inputSwitch>
            <p-slider
              [disabled]="!stylesForm.get('margin.percentage.editable')?.value"
              formControlName="value"
              [min]="0"
              [max]="100"
            ></p-slider>
            <div class="property__measurement-unit">{{stylesForm.get('margin.percentage.value')?.value}}%</div>
          </div>
        </div>

        <div formGroupName="padding">
          <div class="property__name">Padding</div>
          
          <div formGroupName="pixels" class="property__subprop">
            <div class="property__wrapper">
              <p-inputSwitch formControlName="editable"></p-inputSwitch>
              <input [attr.disabled]="stylesForm.get('padding.pixels.editable')?.value ? null : false"
                   formControlName="value" type="text">
              <div class="property__measurement-unit"></div>  
            </div> 
          </div>

          <div formGroupName="percentage" class="property__subprop">
            <p-inputSwitch formControlName="editable"></p-inputSwitch>
            <p-slider
              [disabled]="!stylesForm.get('padding.percentage.editable')?.value"
              formControlName="value"
              [min]="0"
              [max]="100"
            ></p-slider>
            <div class="property__measurement-unit">{{stylesForm.get('padding.percentage.value')?.value}}%</div>
          </div>
        </div>

        <div formGroupName="border">
          <div class="property__name">Border</div>
          
          <div formGroupName="short" class="property__subprop">
            <div class="property__wrapper">
              <p-inputSwitch formControlName="editable"></p-inputSwitch>
              <input #borderShort 
                [attr.disabled]="stylesForm.get('border.short.editable')?.value ? null : false"
                formControlName="value" type="text">
              <input 
                #shortColor 
                [attr.disabled]="stylesForm.get('border.short.editable')?.value ? null : false"
                type="color" 
                (change)="changeColor(borderShort, shortColor.value)">
               <div class="property__measurement-unit"></div>
            </div> 
          </div>

          <div formGroupName="full" class="property__subprop">
            <div class="property__wrapper">
              <p-inputSwitch formControlName="editable"></p-inputSwitch>
              <div class="property__fullBorder">
                <div><input type="text"></div>
                <div><input type="text"></div>
                <div>
                  <input type="text">
                  <input type="color">
                </div>
                <div><input type="text"></div>
                <div><input type="text"></div>
              </div> 
            </div> 
          </div>
        </div>

      </form> -->
    </ng-container>
  </div>
</ng-template>

<ng-template #pixels let-form>
  <ng-container >
    <div [formGroup]="form" class="property__subprop">
      <ng-container formGroupName="pixels"></ng-container>
      <div class="property__wrapper">
         <p-inputSwitch [formControl]="form.get('pixels.editable')"></p-inputSwitch>
        <input [attr.disabled]="form.get('pixels.editable').value ? null : false" [formControl]="form.get('pixels.value')" type="number">
        <div class="property__measurement-unit">px</div>
      </div>
    </div>
  </ng-container>
</ng-template>



<!-- <div formGroupName="percentage" class="property__subprop">
  <p-inputSwitch formControlName="editable"></p-inputSwitch>
  <p-slider
    [disabled]="!stylesForm.get('width.percentage.editable')?.value"
    formControlName="value"
    [min]="0"
    [max]="100"
  ></p-slider>
  <div class="property__measurement-unit">{{stylesForm.get('width.percentage.value')?.value}}%</div>
</div> -->

<ng-template #grid>
  <div class="property">
    <label>
      Block
      <input (change)="displayEvent($event)" [(ngModel)]="display" value="block" type="radio">
    </label>
    <label>
      Flex
      <input (change)="displayEvent($event)" [(ngModel)]="display" value="flex" type="radio">
    </label>
    <label>
      Grid
      <input (change)="displayEvent($event)" [(ngModel)]="display" value="grid" type="radio">
    </label>
  </div>
</ng-template>

<ng-template #flex>
  <div>flex</div>
</ng-template>

<ng-template #accordionList>
  <div class="accordion__list">
    <ng-container *ngFor="let item of sections">
      <div (click)="toggleSection(item)" class="accordion__list-item">
        {{item.name}}
      </div>
    </ng-container>
  </div>
</ng-template>

<ng-template #header let-sectionItem>
  <div class="accordion__panel-header">
    <div class="accordion__back-button" (click)="section = null"> <-- </div>
        <div>{{sectionItem.name}}</div>
    </div>
</ng-template>